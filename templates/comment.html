<!DOCTYPE html>
<html>

<head>
<meta charset="utf-8" />
<title>search_youtube</title>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.31.0/js/jquery.tablesorter.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.31.0/css/theme.default.min.css">
<style>
    #fav-table th {
        background-color: pink;
    }

    .text-content,
    .comment-table {
        max-height: 100px;
        overflow-y: auto;
    }

    .table td {
        max-width: 820px;
        white-space: normal;
        word-wrap: break-word;
    }

    .comment-column {
        width: 50%;
    }

    .indent {
        margin-left: 20px; /* Indent for replies */
        background-color: #f8f9fa; /* Light background color for replies */
    }

    .reply-tag {
        font-weight: bold;
        color: #007bff;
        margin-right: 5px;
    }

    /* カーソルを重ねる要素 */
    .tooltip {
    position: relative; /* ツールチップの位置の基準に */
    cursor: pointer; /* カーソルを当てたときにポインターに */
    }

    /* ツールチップのテキスト */
    .tooltip-text {
    opacity: 0; /* はじめは隠しておく */
    visibility: hidden; /* はじめは隠しておく */
    position: absolute; /* 絶対配置 */
    left: 50%; /* 親に対して中央配置 */
    transform: translateX(-50%); /* 親に対して中央配置 */
    bottom: -30px; /* 親要素下からの位置 */
    display: inline-block;
    padding: 5px; /* 余白 */
    white-space: nowrap; /* テキストを折り返さない */
    font-size: 0.8rem; /* フォントサイズ */
    line-height: 1.3; /* 行間 */
    background: #333; /* 背景色 */
    color: #fff; /* 文字色 */
    border-radius: 3px; /* 角丸 */
    transition: 0.3s ease-in; /* アニメーション */
    }

    /* ホバー時にツールチップの非表示を解除 */
    .tooltip:hover .tooltip-text {
    opacity: 1;
    visibility: visible;
    }
</style>
<script>
    $(document).ready(function() {
        var exp = /(\https:\/\/www.youtube.com\/(watch|shorts)[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;
        $('body').html($('body').html().replace(exp, "<a href='$1' target='_blank'><img height='20' src='images/logo.svg'></a>"));

        $('#fav-table').tablesorter();
        $('.text-content').each(function() {
            var exp_hash = /#+([a-zA-Z0-9亜-熙ぁ-んァ-ヶー-龥朗-鶴.\-_]+)/g;
            var exp = /(\https:\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;
            var txt = $(this).text();
            txt = txt.replace(exp, "<a href='$1' target='_blank'>$1</a>")
            txt = txt.replace(exp_hash, "<a href='https://www.youtube.com/hashtag/$1' target='_blank'>#$1</a>")
            $(this).html(txt);
        });
    });
</script>
</head>

<body>

    <div class="card-body">
        <table id="fav-table" class="table table-bordered">
            <thead>
                <tr>
                    <th>No</th>
                    <th>投稿日時</th>
                    <th>コメント</th>
                    <th>Like数</th>
                    <th>リプライ数</th>
                    <th>ユーザーID</th>
                    <th>icn</th>
                </tr>
            </thead>
            {% for dict in sorce %}
            <tr class="{% if '-' in dict.no %}indent{% endif %}">
                <td>{{ dict.no }}</td>
                <td>{{ dict.publishedAt }}</td>
                <td>
                    {% if '-' in dict.no %}
                        <div class="comment reply-tag" data-bs-toggle="tooltip" data-bs-placement="right" 
                        title="{{ dict.parent_comment }}">
                            >>
                        </div>
                        <!-- <span class="reply-tag">>></span> -->
                    {% endif %}
                    {{ dict.comment }}
                </td>
                <td>{{ dict.like_cnt }}</td>
                <td>{{ dict.reply_cnt }}</td>
                <td>{{ dict.user_name }}</td>
                <td>
                    <a href="{{dict['user_url']}}" target="_blank">
                    <img src="{{dict['user_img']}}" height="48">
                    </a>
                </td>
                <!-- <td>{{ dict.parentId }}</td> -->
            </tr>
            {% endfor %}
        </table>
    </div>
</body>

</html>
